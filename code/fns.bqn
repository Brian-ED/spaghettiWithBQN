Mean â‡(+Â´Ã·â‰ )â€¢BQN
Join â‡âˆ¾Â´
_While_ â‡{ğ”½âŸğ”¾âˆ˜ğ”½_ğ•£_ğ”¾âˆ˜ğ”½âŸğ”¾ğ•©}
ToInt â‡10âŠ¸Ã—âŠ¸+ËœÂ´âˆ˜âŒ½-âŸœ'0'
StartsWith â‡ â‰¤â—‹â‰ â—¶0â€¿(âŠ£â‰¡â‰ âŠ¸â†‘)Ëœ
Print â‡âŠ¢âŠ£"/home/brian/personal/code/py/spaghettiWithBacon/out.txt" â€¢FChars â€¢Repr
IsString â‡{1==ğ•©?âˆ§Â´2=â€¢TypeÂ¨ğ•©;0}
ToPyTuple â‡{'['âˆ¾']'Â«âˆ¾Â´'"'{','âˆ¾ğ•¨âˆ¾Ëœğ•¨âˆ¾âˆ¾Â´"\\"Â¨âŒ¾(('\'â‰¡Â¨ğ•©)âŠ¸/)"\"""Â¨âŒ¾((ğ•¨â‰¡Â¨ğ•©)âŠ¸/)ğ•©}Â¨â¥ŠÂ¨ğ•©}

mediaryLang â‡{
    # ğ•© â‰¡â‰¡â‰¡ types
    PrefixedInteger â‡âŠ¢(âŠ¢âˆ¾âŸœToInt 1â†“â†‘Ëœ)1+âŸœ(+Â´âˆ§`)1â†“âˆŠâŸœ('0'+â†•10)

    pyEval â‡<"notDefined"

    CollapseInts â‡{
        # âŸ¨ 's' âŸ¨ 3 3 3 âŸ© 's' 's' âŸ¨ 2 âŸ© 'n' 'n' 'n' 'n' âŸ© â‰¡ CollapseInts "sl3 3 3ssl2nnnn"
        # TODO can be massively simplified
        ğ•Š doneâ€¿types:
            'l'â‰¡âŠ‘types?
            lenOfArgâ€¿listLenâ†PrefixedInteger types
            âŒ½âŒ¾(âŠ‘âŒ½âˆ˜âŠ‘){ ğ•Š doneâ€¿types:
                lenOfArgâ€¿listLenâ†PrefixedInteger types
                âŸ¨(listLenâŠ¸âˆ¾âŒ¾(âŠ‘âŒ½)done),lenOfArgâ†“typesâŸ©
            } _While_ {' 'â‰¡âŠ‘1âŠ‘ğ•©}âŸ(0=âŸœâ‰ 1âŸœâŠ‘) Print âŸ¨doneâˆ¾âŸ¨âŸ¨listLenâŸ©âŸ©,lenOfArgâ†“typesâŸ©;
        ğ•Š doneâ€¿types:
            (1âŠ¸â†“â‹ˆËœdoneâˆ¾âŠ‘)types
    }_While_(""â‰¢âŠ‘âˆ˜âŒ½)

    GroupTypesâ‡{
        ğ•Š argsâ€¿doneâ€¿types:
            0â‰¡â€¢Type âŠ‘types?
                âŸ¨args
                done (<âˆ˜â¥Šâˆ¾Ã—Â´âŠ¸â†“)Ëœ âŠ‘types
                1â†“typesâŸ©;

        ğ•Š argsâ€¿doneâ€¿types:
            âŸ¨1â†“args
            done âˆ¾Ëœ args {ğ•ğ•¨}â—‹âŠ‘ ToIntâ€¿<â€¿âŠ¢â€¿â€¢BQNâ€¿ PyEval/Ëœ"nscfF"=âŠ‘types
            1â†“typesâŸ©
    }_While_(""â‰¢âŠ‘âˆ˜âŒ½)

    ExtractTypes â‡{
        IsString ğ•©? 's';
        0=â€¢Type ğ•©?
            âˆ¾Â´('l'Â»Â«""âˆ¾Â´' 'âˆ¾Â¨â€¢ReprÂ¨â‰¢ğ•©)âˆ¾âˆ¾Â´ğ•ŠÂ¨â¥Šğ•©;
        "ncf"âŠ‘Ëœ2âŒŠÂ¯1+â€¢Type ğ•©
    }

    Crunchâ†{
        xâ†âŸ¨âŸ©
        IsStringâ—¶{
            xâˆ¾â†©â€¢ReprâŸ(2â‰ â€¢Type)Â¨â¥Šğ•©
        }â€¿{
            xâˆ¾â†©<ğ•©
        }âš‡1ğ•©
        x
    }

    Handler â‡{
        ğ•Šâ¼: (ExtractTypes <âŠ¸âˆ¾ Crunch) ğ•©;

        types â†âŠ‘ğ•©
        args â†1â†“ğ•©

        intStrTypes â†âŠ‘ CollapseInts âŸ¨âŸ©â€¿types

        1âŠ‘ GroupTypes âŒ½Â¨argsâ€¿âŸ¨âŸ©â€¿intStrTypes
    }
}
{ğ•Š:
â€¢Show mediaryLang.Handlerâ¼ â€¢Show mediaryLang.Handler âŸ¨"l3l3 4ccccccccccccl2 3nnnnnnl5ccl3sl2nnnnn","t","h","i","s","i","s"," ","a","t","e","s","t","1","2","3","4","5","6","a","b","nested","3","2","1","2","3"âŸ©
}âŸ0@ #testing on or off