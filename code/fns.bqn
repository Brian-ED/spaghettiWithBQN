Mean â‡(+Â´Ã·â‰ )â€¢BQN
Join â‡âˆ¾Â´
_While_ â‡{ğ”½âŸğ”¾âˆ˜ğ”½_ğ•£_ğ”¾âˆ˜ğ”½âŸğ”¾ğ•©}
ToInt â‡10âŠ¸Ã—âŠ¸+ËœÂ´âˆ˜âŒ½-âŸœ'0'
StartsWith â‡ â‰¤â—‹â‰ â—¶0â€¿(âŠ£â‰¡â‰ âŠ¸â†‘)Ëœ

mediaryLang â‡{
    # ğ•© â‰¡â‰¡â‰¡ types
    PrefixedInteger â‡âŠ¢(âŠ¢âˆ¾âŸœToInt 1â†“â†‘Ëœ)1+âŸœ(+Â´âˆ§`)1â†“âˆŠâŸœ('0'+â†•10)

    pyEval â‡<"notDefined"

    CollapseInts â‡{
        # âŸ¨ 's' âŸ¨ 3 3 3 âŸ© 's' 's' âŸ¨ 2 âŸ© 'n' 'n' 'n' 'n' âŸ© â‰¡ CollapseInts "sl3 3 3ssl2nnnn"
        # TODO can be massively simplified
        ğ•Š doneâ€¿types:
            'l'â‰¡âŠ‘types?
            lenOfArgâ€¿listLenâ†PrefixedInteger types
            { ğ•Š doneâ€¿types:
                lenOfArgâ€¿listLenâ†PrefixedInteger types
                âŸ¨(listLenâŠ¸âˆ¾âŒ¾(âŠ‘âŒ½)done),lenOfArgâ†“typesâŸ©
            } _While_ {' 'â‰¡âŠ‘1âŠ‘ğ•©} âŸ¨doneâˆ¾âŸ¨âŸ¨listLenâŸ©âŸ©,lenOfArgâ†“typesâŸ©;

        ğ•Š doneâ€¿types:
            (doneâˆ¾âŠ‘types)â€¿(1â†“types)

    }_While_(""â‰¢âŠ‘âˆ˜âŒ½)

    GroupTypesâ‡{
        ğ•Š argsâ€¿doneâ€¿types:
            0â‰¡â€¢Type âŠ‘types?
                âŸ¨args
                done (<âˆ˜â¥Šâˆ¾Ã—Â´âŠ¸â†“)Ëœ âŠ‘types
                1â†“typesâŸ©;

        ğ•Š argsâ€¿doneâ€¿types:
            âŸ¨1â†“args
            done âˆ¾Ëœ args {ğ•ğ•¨}â—‹âŠ‘ ToIntâ€¿<â€¿âŠ¢â€¿â€¢BQNâ€¿ PyEval/Ëœ"nscfF"=âŠ‘types
            1â†“typesâŸ©

    }_While_(""â‰¢âŠ‘âˆ˜âŒ½)

    Handler â‡{
        types â†âŠ‘ğ•©
        args â†1â†“ğ•©

        intStrTypes â†âŠ‘ CollapseInts âŸ¨âŸ©â€¿types

        1âŠ‘ GroupTypes âŒ½Â¨argsâ€¿âŸ¨âŸ©â€¿intStrTypes
    }
}

{ğ•Š:
â€¢Show mediaryLang.Handler âŸ¨"l3l4 3ccccccccccccl3 2nnnnnnl5ccl3sl2nnnnn","t","h","i","s","i","s"," ","a","t","e","s","t","1","2","3","4","5","6","a","b","nested","3","2","1","2","3"âŸ©
}âŸ0 0 #testing on or off